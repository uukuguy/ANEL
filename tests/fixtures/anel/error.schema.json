{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "QMD ANEL Error Contract",
  "description": "Contract specification for ANEL error format (RFC 7807 extended)",
  "type": "object",
  "required": ["error_code", "status", "title", "message", "severity"],
  "properties": {
    "error_code": {
      "type": "string",
      "enum": [
        "UNKNOWN",
        "INVALID_INPUT",
        "NOT_FOUND",
        "PERMISSION_DENIED",
        "SEARCH_FAILED",
        "INDEX_NOT_READY",
        "QUERY_PARSE_ERROR",
        "COLLECTION_NOT_FOUND",
        "COLLECTION_EXISTS",
        "COLLECTION_CORRUPTED",
        "EMBEDDING_FAILED",
        "MODEL_NOT_FOUND",
        "MODEL_LOAD_FAILED",
        "STORAGE_ERROR",
        "BACKEND_UNAVAILABLE",
        "CONFIG_ERROR",
        "ENVIRONMENT_ERROR"
      ],
      "description": "ANEL error code"
    },
    "status": {
      "type": "integer",
      "description": "HTTP-style status code"
    },
    "title": {
      "type": "string",
      "description": "Error title"
    },
    "message": {
      "type": "string",
      "description": "Detailed error message"
    },
    "severity": {
      "type": "string",
      "enum": ["debug", "info", "warning", "error", "critical"],
      "description": "Error severity level"
    },
    "recovery_hints": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/RecoveryHint"
      },
      "description": "Recovery hints for error resolution"
    },
    "trace_id": {
      "type": ["string", "null"],
      "description": "Request trace ID for correlation"
    }
  },
  "definitions": {
    "RecoveryHint": {
      "type": "object",
      "required": ["code", "message"],
      "properties": {
        "code": {
          "type": "string",
          "description": "Hint code"
        },
        "message": {
          "type": "string",
          "description": "Human-readable hint message"
        },
        "action": {
          "type": ["string", "null"],
          "description": "Suggested action to resolve the error"
        }
      }
    }
  }
}
